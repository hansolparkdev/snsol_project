{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.6efe455167e8c7d6475d.hot-update.js","sources":["webpack:///./redux/sagas/login.js"],"sourcesContent":["import { takeEvery, put, call } from 'redux-saga/effects';\r\nimport axios from 'axios';\r\nimport {\r\n  SET_USERNAME_STARTED, SET_PASSWORD_STARTED,\r\n  SET_USERNAME, SET_PASSWORD, DO_LOGIN, DO_LOGIN_STARTED,\r\n  DO_LOGIN_SUCCESS, DO_LOGIN_FAIL, SESSION_CHECK, SESSION_CHECK_STARTED,\r\n  SESSION_CHECK_HAVE, SESSION_CHECK_NONE,\r\n} from '../reducers/sagaLoginReducer';\r\n// import { SAGA_SIGN_IN } from '../reducers/sagaLoginReducer';\r\n\r\nconst setUsername = function* setUsername(action) {\r\n  yield put({ type: SET_USERNAME_STARTED, payload: action.payload });\r\n};\r\nconst setPassword = function* setPassword(action) {\r\n  yield put({ type: SET_PASSWORD_STARTED, payload: action.payload });\r\n};\r\nconst doLogin = function* doLogin(action) {\r\n  // yield console.log(action);\r\n  try {\r\n    yield put({ type: DO_LOGIN_STARTED });\r\n    const json = {\r\n      uid: action.payload.username,\r\n      upw: action.payload.password,\r\n    };\r\n    // console.log(json);\r\n    const { data } = yield call([axios, 'post'], 'http://127.0.0.1:3001/auth/signin', json, {\r\n      withCredentials: true, // 쿠키를 주고받을 수 있게됨\r\n    });\r\n    yield put({ type: DO_LOGIN_SUCCESS });\r\n  } catch (e) {\r\n    yield put({ type: DO_LOGIN_FAIL });\r\n  }\r\n};\r\nconst sessionCheck = function* sessionCheck() {\r\n  try {\r\n    yield put({ type: SESSION_CHECK_STARTED });\r\n    const { data } = yield call([axios, 'get'], 'http://127.0.0.1:3001/auth/session_check', {\r\n      withCredentials: true,\r\n    });\r\n    console.log(data.session_data.user);\r\n    if (data.session_data.user === '') {\r\n      yield put({ type: SESSION_CHECK_NONE});\r\n    } else {\r\n      yield put({ type: SESSION_CHECK_HAVE, payload: data });\r\n    }\r\n    // console.log(data);\r\n  } catch (e) {\r\n    yield put({});\r\n  }\r\n};\r\n// watch\r\nexport const watchSetUsername = function* watchSetUsername() {\r\n  yield takeEvery(SET_USERNAME, setUsername);\r\n};\r\nexport const watchSetUserpassword = function* watchSetUserpassword() {\r\n  yield takeEvery(SET_PASSWORD, setPassword);\r\n};\r\n\r\nexport const watchLogin = function* watchLogin() {\r\n  yield takeEvery(DO_LOGIN, doLogin);\r\n};\r\n\r\nexport const watchSession = function* wathchSession() {\r\n  yield takeEvery(SESSION_CHECK, sessionCheck);\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAJA;AAIA;AACA;AACA;AAFA;AACA;AALA;AASA;AACA;AACA;AAFA;AACA;AAVA;AAAA;AASA;AATA;AAYA;AAAA;AAAA;AACA;AAbA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAcA;AAAA;AAAA;AACA;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAgBA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAHA;AAAA;AAGA;AACA;AADA;AACA;AAJA;AAAA;AAGA;AAGA;AACA;AAPA;AAAA;AAAA;AAAA;AACA;AADA;AAQA;AAAA;AAAA;AACA;AATA;AAAA;AAAA;AACA;AADA;AAAA;AAUA;AAAA;AAAA;AAAA;AACA;AAXA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAcA;AACA;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAgBA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}