{"ast":null,"code":"import { takeEvery, put, call } from 'redux-saga/effects';\nimport axios from 'axios';\nimport { SET_USERNAME_STARTED, SET_PASSWORD_STARTED, SET_USERNAME, SET_PASSWORD, DO_LOGIN, DO_LOGIN_STARTED, DO_LOGIN_SUCCESS, DO_LOGIN_FAIL, SESSION_CHECK, SESSION_CHECK_STARTED, SESSION_CHECK_HAVE, SESSION_CHECK_NONE } from '../reducers/sagaLoginReducer'; // import { SAGA_SIGN_IN } from '../reducers/sagaLoginReducer';\n\nconst setUsername = function* setUsername(action) {\n  yield put({\n    type: SET_USERNAME_STARTED,\n    payload: action.payload\n  });\n};\n\nconst setPassword = function* setPassword(action) {\n  yield put({\n    type: SET_PASSWORD_STARTED,\n    payload: action.payload\n  });\n};\n\nconst doLogin = function* doLogin(action) {\n  // yield console.log(action);\n  try {\n    yield put({\n      type: DO_LOGIN_STARTED\n    });\n    const json = {\n      uid: action.payload.username,\n      upw: action.payload.password\n    }; // console.log(json);\n\n    const {\n      data\n    } = yield call([axios, 'post'], 'http://127.0.0.1:3001/auth/signin', json, {\n      withCredentials: true // 쿠키를 주고받을 수 있게됨\n\n    });\n    yield put({\n      type: DO_LOGIN_SUCCESS\n    });\n  } catch (e) {\n    console.log(data);\n    yield put({\n      type: DO_LOGIN_FAIL\n    });\n  }\n};\n\nconst sessionCheck = function* sessionCheck() {\n  try {\n    yield put({\n      type: SESSION_CHECK_STARTED\n    });\n    const {\n      data\n    } = yield call([axios, 'get'], 'http://127.0.0.1:3001/auth/session_check', {\n      withCredentials: true\n    }); // console.log(data.session_data.user);\n\n    if (data.session_data.user === '') {\n      yield put({\n        type: SESSION_CHECK_NONE\n      });\n    } else {\n      yield put({\n        type: SESSION_CHECK_HAVE,\n        payload: data\n      });\n    } // console.log(data);\n\n  } catch (e) {\n    yield put({});\n  }\n}; // watch\n\n\nexport const watchSetUsername = function* watchSetUsername() {\n  yield takeEvery(SET_USERNAME, setUsername);\n};\nexport const watchSetUserpassword = function* watchSetUserpassword() {\n  yield takeEvery(SET_PASSWORD, setPassword);\n};\nexport const watchLogin = function* watchLogin() {\n  yield takeEvery(DO_LOGIN, doLogin);\n};\nexport const watchSession = function* wathchSession() {\n  yield takeEvery(SESSION_CHECK, sessionCheck);\n};","map":{"version":3,"sources":["D:/Desktop/snsol_project/frontend/redux/sagas/login.js"],"names":["takeEvery","put","call","axios","SET_USERNAME_STARTED","SET_PASSWORD_STARTED","SET_USERNAME","SET_PASSWORD","DO_LOGIN","DO_LOGIN_STARTED","DO_LOGIN_SUCCESS","DO_LOGIN_FAIL","SESSION_CHECK","SESSION_CHECK_STARTED","SESSION_CHECK_HAVE","SESSION_CHECK_NONE","setUsername","action","type","payload","setPassword","doLogin","json","uid","username","upw","password","data","withCredentials","e","console","log","sessionCheck","session_data","user","watchSetUsername","watchSetUserpassword","watchLogin","watchSession","wathchSession"],"mappings":"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","sourcesContent":["import { takeEvery, put, call } from 'redux-saga/effects';\r\nimport axios from 'axios';\r\nimport {\r\n  SET_USERNAME_STARTED, SET_PASSWORD_STARTED,\r\n  SET_USERNAME, SET_PASSWORD, DO_LOGIN, DO_LOGIN_STARTED,\r\n  DO_LOGIN_SUCCESS, DO_LOGIN_FAIL, SESSION_CHECK, SESSION_CHECK_STARTED,\r\n  SESSION_CHECK_HAVE, SESSION_CHECK_NONE,\r\n} from '../reducers/sagaLoginReducer';\r\n// import { SAGA_SIGN_IN } from '../reducers/sagaLoginReducer';\r\n\r\nconst setUsername = function* setUsername(action) {\r\n  yield put({ type: SET_USERNAME_STARTED, payload: action.payload });\r\n};\r\nconst setPassword = function* setPassword(action) {\r\n  yield put({ type: SET_PASSWORD_STARTED, payload: action.payload });\r\n};\r\nconst doLogin = function* doLogin(action) {\r\n  // yield console.log(action);\r\n  try {\r\n    yield put({ type: DO_LOGIN_STARTED });\r\n    const json = {\r\n      uid: action.payload.username,\r\n      upw: action.payload.password,\r\n    };\r\n    // console.log(json);\r\n    const { data } = yield call([axios, 'post'], 'http://127.0.0.1:3001/auth/signin', json, {\r\n      withCredentials: true, // 쿠키를 주고받을 수 있게됨\r\n    });\r\n    yield put({ type: DO_LOGIN_SUCCESS });\r\n  } catch (e) {\r\n    console.log(data);\r\n    yield put({ type: DO_LOGIN_FAIL });\r\n  }\r\n};\r\nconst sessionCheck = function* sessionCheck() {\r\n  try {\r\n    yield put({ type: SESSION_CHECK_STARTED });\r\n    const { data } = yield call([axios, 'get'], 'http://127.0.0.1:3001/auth/session_check', {\r\n      withCredentials: true,\r\n    });\r\n    // console.log(data.session_data.user);\r\n    if (data.session_data.user === '') {\r\n      yield put({ type: SESSION_CHECK_NONE });\r\n    } else {\r\n      yield put({ type: SESSION_CHECK_HAVE, payload: data });\r\n    }\r\n    // console.log(data);\r\n  } catch (e) {\r\n    yield put({});\r\n  }\r\n};\r\n// watch\r\nexport const watchSetUsername = function* watchSetUsername() {\r\n  yield takeEvery(SET_USERNAME, setUsername);\r\n};\r\nexport const watchSetUserpassword = function* watchSetUserpassword() {\r\n  yield takeEvery(SET_PASSWORD, setPassword);\r\n};\r\n\r\nexport const watchLogin = function* watchLogin() {\r\n  yield takeEvery(DO_LOGIN, doLogin);\r\n};\r\n\r\nexport const watchSession = function* wathchSession() {\r\n  yield takeEvery(SESSION_CHECK, sessionCheck);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}