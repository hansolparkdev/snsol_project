{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport { takeEvery, put, call } from 'redux-saga/effects';\nimport axios from 'axios';\nimport { SET_USERNAME_STARTED, SET_PASSWORD_STARTED, SET_USERNAME, SET_PASSWORD, DO_LOGIN, DO_LOGIN_STARTED, DO_LOGIN_SUCCESS, DO_LOGIN_FAIL, SESSION_CHECK, SESSION_CHECK_STARTED, SESSION_CHECK_HAVE, SESSION_CHECK_NONE } from '../reducers/sagaLoginReducer'; // import { SAGA_SIGN_IN } from '../reducers/sagaLoginReducer';\n\nvar setUsername = /*#__PURE__*/_regeneratorRuntime.mark(function setUsername(action) {\n  return _regeneratorRuntime.wrap(function setUsername$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return put({\n            type: SET_USERNAME_STARTED,\n            payload: action.payload\n          });\n\n        case 2:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, setUsername);\n});\n\nvar setPassword = /*#__PURE__*/_regeneratorRuntime.mark(function setPassword(action) {\n  return _regeneratorRuntime.wrap(function setPassword$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return put({\n            type: SET_PASSWORD_STARTED,\n            payload: action.payload\n          });\n\n        case 2:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, setPassword);\n});\n\nvar doLogin = /*#__PURE__*/_regeneratorRuntime.mark(function doLogin(action) {\n  var json, _ref, data;\n\n  return _regeneratorRuntime.wrap(function doLogin$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          _context3.next = 3;\n          return put({\n            type: DO_LOGIN_STARTED\n          });\n\n        case 3:\n          json = {\n            uid: action.payload.username,\n            upw: action.payload.password\n          }; // console.log(json);\n\n          _context3.next = 6;\n          return call([axios, 'post'], 'http://127.0.0.1:3001/auth/signin', json, {\n            withCredentials: true // 쿠키를 주고받을 수 있게됨\n\n          });\n\n        case 6:\n          _ref = _context3.sent;\n          data = _ref.data;\n          _context3.next = 10;\n          return put({\n            type: DO_LOGIN_SUCCESS\n          });\n\n        case 10:\n          _context3.next = 16;\n          break;\n\n        case 12:\n          _context3.prev = 12;\n          _context3.t0 = _context3[\"catch\"](0);\n          _context3.next = 16;\n          return put({\n            type: DO_LOGIN_FAIL\n          });\n\n        case 16:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, doLogin, null, [[0, 12]]);\n});\n\nvar sessionCheck = /*#__PURE__*/_regeneratorRuntime.mark(function sessionCheck() {\n  var _ref2, data;\n\n  return _regeneratorRuntime.wrap(function sessionCheck$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.prev = 0;\n          _context4.next = 3;\n          return put({\n            type: SESSION_CHECK_STARTED\n          });\n\n        case 3:\n          _context4.next = 5;\n          return call([axios, 'get'], 'http://127.0.0.1:3001/auth/session_check', {\n            withCredentials: true\n          });\n\n        case 5:\n          _ref2 = _context4.sent;\n          data = _ref2.data;\n\n          if (!(data.session_data.user === '')) {\n            _context4.next = 12;\n            break;\n          }\n\n          _context4.next = 10;\n          return put({\n            type: SESSION_CHECK_NONE\n          });\n\n        case 10:\n          _context4.next = 14;\n          break;\n\n        case 12:\n          _context4.next = 14;\n          return put({\n            type: SESSION_CHECK_HAVE,\n            payload: data\n          });\n\n        case 14:\n          _context4.next = 20;\n          break;\n\n        case 16:\n          _context4.prev = 16;\n          _context4.t0 = _context4[\"catch\"](0);\n          _context4.next = 20;\n          return put({});\n\n        case 20:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, sessionCheck, null, [[0, 16]]);\n}); // watch\n\n\nexport var watchSetUsername = /*#__PURE__*/_regeneratorRuntime.mark(function watchSetUsername() {\n  return _regeneratorRuntime.wrap(function watchSetUsername$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return takeEvery(SET_USERNAME, setUsername);\n\n        case 2:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, watchSetUsername);\n});\nexport var watchSetUserpassword = /*#__PURE__*/_regeneratorRuntime.mark(function watchSetUserpassword() {\n  return _regeneratorRuntime.wrap(function watchSetUserpassword$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.next = 2;\n          return takeEvery(SET_PASSWORD, setPassword);\n\n        case 2:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, watchSetUserpassword);\n});\nexport var watchLogin = /*#__PURE__*/_regeneratorRuntime.mark(function watchLogin() {\n  return _regeneratorRuntime.wrap(function watchLogin$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.next = 2;\n          return takeEvery(DO_LOGIN, doLogin);\n\n        case 2:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, watchLogin);\n});\nexport var watchSession = /*#__PURE__*/_regeneratorRuntime.mark(function wathchSession() {\n  return _regeneratorRuntime.wrap(function wathchSession$(_context8) {\n    while (1) {\n      switch (_context8.prev = _context8.next) {\n        case 0:\n          _context8.next = 2;\n          return takeEvery(SESSION_CHECK, sessionCheck);\n\n        case 2:\n        case \"end\":\n          return _context8.stop();\n      }\n    }\n  }, wathchSession);\n});","map":{"version":3,"sources":["D:/Desktop/snsol_project/frontend/redux/sagas/login.js"],"names":["takeEvery","put","call","axios","SET_USERNAME_STARTED","SET_PASSWORD_STARTED","SET_USERNAME","SET_PASSWORD","DO_LOGIN","DO_LOGIN_STARTED","DO_LOGIN_SUCCESS","DO_LOGIN_FAIL","SESSION_CHECK","SESSION_CHECK_STARTED","SESSION_CHECK_HAVE","SESSION_CHECK_NONE","setUsername","action","type","payload","setPassword","doLogin","json","uid","username","upw","password","withCredentials","data","sessionCheck","session_data","user","watchSetUsername","watchSetUserpassword","watchLogin","watchSession","wathchSession"],"mappings":"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","sourcesContent":["import { takeEvery, put, call } from 'redux-saga/effects';\r\nimport axios from 'axios';\r\nimport {\r\n  SET_USERNAME_STARTED, SET_PASSWORD_STARTED,\r\n  SET_USERNAME, SET_PASSWORD, DO_LOGIN, DO_LOGIN_STARTED,\r\n  DO_LOGIN_SUCCESS, DO_LOGIN_FAIL, SESSION_CHECK, SESSION_CHECK_STARTED,\r\n  SESSION_CHECK_HAVE, SESSION_CHECK_NONE,\r\n} from '../reducers/sagaLoginReducer';\r\n// import { SAGA_SIGN_IN } from '../reducers/sagaLoginReducer';\r\n\r\nconst setUsername = function* setUsername(action) {\r\n  yield put({ type: SET_USERNAME_STARTED, payload: action.payload });\r\n};\r\nconst setPassword = function* setPassword(action) {\r\n  yield put({ type: SET_PASSWORD_STARTED, payload: action.payload });\r\n};\r\nconst doLogin = function* doLogin(action) {\r\n  // yield console.log(action);\r\n  try {\r\n    yield put({ type: DO_LOGIN_STARTED });\r\n    const json = {\r\n      uid: action.payload.username,\r\n      upw: action.payload.password,\r\n    };\r\n    // console.log(json);\r\n    const { data } = yield call([axios, 'post'], 'http://127.0.0.1:3001/auth/signin', json, {\r\n      withCredentials: true, // 쿠키를 주고받을 수 있게됨\r\n    });\r\n    yield put({ type: DO_LOGIN_SUCCESS });\r\n  } catch (e) {\r\n    yield put({ type: DO_LOGIN_FAIL });\r\n  }\r\n};\r\nconst sessionCheck = function* sessionCheck() {\r\n  try {\r\n    yield put({ type: SESSION_CHECK_STARTED });\r\n    const { data } = yield call([axios, 'get'], 'http://127.0.0.1:3001/auth/session_check', {\r\n      withCredentials: true,\r\n    });\r\n    // console.log(data.session_data.user);\r\n    if (data.session_data.user === '') {\r\n      yield put({ type: SESSION_CHECK_NONE });\r\n    } else {\r\n      yield put({ type: SESSION_CHECK_HAVE, payload: data });\r\n    }\r\n    // console.log(data);\r\n  } catch (e) {\r\n    yield put({});\r\n  }\r\n};\r\n// watch\r\nexport const watchSetUsername = function* watchSetUsername() {\r\n  yield takeEvery(SET_USERNAME, setUsername);\r\n};\r\nexport const watchSetUserpassword = function* watchSetUserpassword() {\r\n  yield takeEvery(SET_PASSWORD, setPassword);\r\n};\r\n\r\nexport const watchLogin = function* watchLogin() {\r\n  yield takeEvery(DO_LOGIN, doLogin);\r\n};\r\n\r\nexport const watchSession = function* wathchSession() {\r\n  yield takeEvery(SESSION_CHECK, sessionCheck);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}